{"mappings":"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","sources":["src/js/library.js","src/templates/library-default.hbs","src/js/libraryFromLocalStorage.js"],"sourcesContent":["import refsList from './refs';\n/* import { renderList } from './renderFilmList'; */\nimport createDefaultMarkUp from '../templates/library-default.hbs';\nimport createMarkUp from '../templates/films-card.hbs';\nimport {\n  fetchTrendingMovies,\n  fetchGenres,\n  fetchMovieById,\n} from './fetchMovies';\nimport { onOpenModal } from './modal';\n\nconst refs = refsList();\n\n/* defaultPageShow(); */\n\n/* const watched = [\n  807356, 414906\n];\nconst queue = [595586]; // пробный массив\nconst KEY__WATCHED = 'watched';\nconst KEY__QUEUE = 'queue';\nlocalStorage.setItem(KEY__WATCHED, JSON.stringify(watched)); //убрать\nlocalStorage.setItem(KEY__QUEUE, JSON.stringify(queue)); //убрать\nlet watchedMovies;\nlet queueMovies; */\n\n/* libraryMainPage(); */\n\n/* async function libraryMainPage() {\n  if (JSON.parse(localStorage.getItem(KEY__WATCHED)).length !== 0) {\n    const movies = await renderWatchedMoviesList();\n    renderWatchedCards(movies);\n  }\n}\n */\nexport function defaultPageShow() {\n  fetchTrendingMovies(3).then(data => {\n    if (data) {\n      renderList(data.results);\n    }\n  });\n\n  async function renderList(data) {\n    const genersList = await fetchGenres();\n    data.forEach(el => {\n      const newArr = [];\n      el.genre_ids.forEach(gener => {\n        const newEl = genersList.find(x => x.id === gener);\n        newArr.push(newEl.name);\n      });\n\n      if (newArr.length > 2) {\n        newArr.splice(2, newArr.length - 2, 'Other');\n      }\n\n      el.genre_ids = newArr.join(', ');\n    });\n\n    const markup = data\n      .map(film => {\n        return createDefaultMarkUp(film);\n      })\n      .slice(0, 6)\n      .join('');\n\n    if (refs.libraryMoviesList) {\n      refs.libraryMoviesList.insertAdjacentHTML('beforeend', markup);\n    }\n\n    refsList().filmsElements.forEach(card =>\n      card.addEventListener('click', onOpenModal)\n    );\n  }\n}\n/* if (\n  JSON.parse(!localStorage.getItem(KEY__WATCHED)) ||\n  JSON.parse(localStorage.getItem(KEY__WATCHED)).length === 0\n) {\n  defaultPageShow();\n} */\n\n// Wached -> queue button part\n\n/* if (refs.libraryWatchedBtn)\n  refs.libraryWatchedBtn.addEventListener('click', onWatchedBtn);\nif (refs.libraryQueueBtn)\n  refs.libraryQueueBtn.addEventListener('click', onQueueBtn);\n\n// WATCHED BTN\n\nasync function onWatchedBtn() {\n  defaultContainerBuild();\n\n  if (JSON.parse(localStorage.getItem(KEY__WATCHED)).length === 0) {\n    defaultPageShow();\n  }\n\n  if (JSON.parse(localStorage.getItem(KEY__WATCHED)).length !== 0) {\n    defaultClean();\n    const movies = await renderWatchedMoviesList();\n    renderWatchedCards(movies);\n  }\n  if (refs.libraryWatchedBtn)\n    refs.libraryWatchedBtn.classList.add('header-library__btn-current');\n  if (refs.libraryQueueBtn)\n    refs.libraryQueueBtn.classList.remove('header-library__btn-current');\n}\n\n// ======== watched & queue = keys from localStorage ==========\n\nasync function renderWatchedMoviesList() {\n  try {\n    watchedMovies = JSON.parse(localStorage.getItem(KEY__WATCHED));\n  } catch (error) {\n    console.log(error.name);\n    console.log(error.message);\n  }\n\n  const arrayOfPromises = watchedMovies.map(async movieId => {\n    const response = await fetchMovieById(movieId);\n    return response;\n  });\n\n  const movies = await Promise.all(arrayOfPromises);\n  return movies;\n}\nfunction renderWatchedCards(movies) {\n  console.log(movies);\n  const genres = movies.map(movie => movie.genres.map(genre => genre.name));\n  movies.map((movie, i) => (movie.genre_ids = genres[i].join(', ')));\n\n  const markup = movies.map(movie => createMarkUp(movie)).join('');\n  defaultClean();\n  if (refs.libraryMoviesList)\n    refs.libraryMoviesList.insertAdjacentHTML('beforeend', markup);\n\n  refsList().filmsElements.forEach(card =>\n    card.addEventListener('click', onOpenModal)\n  );\n}\n\nfunction defaultClean() {\n  if (refs.libraryMoviesList) refs.libraryMoviesList.innerHTML = '';\n  if (refs.libraryDefaultContainer)\n    refs.libraryDefaultContainer.style.display = 'none';\n}\n\nfunction defaultContainerBuild() {\n  if (refs.libraryMoviesList) refs.libraryMoviesList.innerHTML = '';\n  if (refs.libraryDefaultContainer)\n    refs.libraryDefaultContainer.style.display = 'flex';\n}\n\n// QUEUE BTN\n\nasync function onQueueBtn() {\n  if (refs.libraryQueueBtn)\n    refs.libraryQueueBtn.classList.add('header-library__btn-current');\n  if (refs.libraryWatchedBtn)\n    refs.libraryWatchedBtn.classList.remove('header-library__btn-current');\n  if (\n    !JSON.parse(localStorage.getItem(KEY__QUEUE)) ||\n    JSON.parse(localStorage.getItem(KEY__QUEUE)).length === 0\n  ) {\n    defaultContainerBuild();\n    defaultPageShow();\n  }\n  if (JSON.parse(localStorage.getItem(KEY__QUEUE)).length !== 0) {\n    const movies = await renderQueueMoviesList();\n    renderWatchedCards(movies);\n  }\n}\n\nasync function renderQueueMoviesList() {\n  try {\n    queueMovies = JSON.parse(localStorage.getItem(KEY__QUEUE));\n  } catch (error) {\n    console.log(error.name);\n    console.log(error.message);\n  }\n\n  const arrayOfPromises = queueMovies.map(async movieId => {\n    const response = await fetchMovieById(movieId);\n    return response;\n  });\n\n  const movies = await Promise.all(arrayOfPromises);\n  return movies;\n}\n */\n","<li class='library-default-film-card' data-action='{{this.id}}' data-modal-open>\n\n    <img class='library-default-film-card__img' src='https://image.tmdb.org/t/p/w500{{this.poster_path}}' alt='{{original_title}} '\n        width='190'\n        onerror=\"this.onerror=null;this.src='https://ik.imagekit.io/tc8jxffbcvf/default-movie-portrait_EmJUj9Tda5wa.jpg?tr=fo-auto,di-';\" />\n\n    <div class='library-default-film-card__wrapper'>\n        <h2 class='library-default-film-card__title'>{{this.title}} {{this.name}} ({{this.release_date}})</h2>\n        <p class='library-default-film-card__discription'>\n            <span class='library-default-film-card__genres'>{{this.genre_ids}}</span>\n        </p>\n    </div>\n\n</li>","import { defaultPageShow } from './library';\nimport refsList from './refs';\nimport createMarkUp from '../templates/films-card.hbs';\nimport { onOpenModal } from './modal';\n\nconst watched = [\n  /*   {\n    poster_path: '/wdbiMjXd4CxPfCx4r4Jfy8cGec0.jpg',\n    id: '11111',\n    title: 'My policeman',\n    vote_average: '8.249',\n    vote_count: '177',\n    popularity: '290.839',\n    overview:\n      'In the late 1990s, the arrival of elderly invalid Patrick into Marion and Tom’s home triggers the exploration of seismic events from 40 years previous: the passionate relationship between Tom and Patrick at a time when homosexuality was illegal.',\n    genre_ids: 'Drama, Romance',\n    release_date: '2022-11-04',\n  },\n\n  {\n    poster_path: '/wdbiMjXd4CxPfCx4r4Jfy8cGec0.jpg',\n    id: '2222',\n    title: 'My policeman',\n    vote_average: '8.249',\n    vote_count: '177',\n    popularity: '290.839',\n    overview:\n      'In the late 1990s, the arrival of elderly invalid Patrick into Marion and Tom’s home triggers the exploration of seismic events from 40 years previous: the passionate relationship between Tom and Patrick at a time when homosexuality was illegal.',\n    genre_ids: 'Drama, Romance',\n    release_date: '2022-11-04',\n  },\n\n  {\n    poster_path: document.querySelector('.modal-card__img').src.slice(31),\n    id: document.querySelector('.modal-card__img').dataset.id,\n    title: document.querySelector('.film-card-content__title').textContent,\n    vote_average: document.querySelector('.rating').textContent,\n    genre_ids: document.querySelector('.film-card-content__item-text-right').textContent,\n    release_date: document.querySelector('.film-card-content__title').dataset.date,\n  }, */\n];\nconst phrase =\n  'https://image.tmdb.org/t/p/w500/wdbiMjXd4CxPfCx4r4Jfy8cGec0.jpg';\nconsole.log(phrase.slice(31));\n\nconst queue = [\n  {\n    poster_path: '/5EB9LAzIePTQoMpg2M1GNJpNn9s.jpg',\n    id: '11111',\n    title: 'King Lines',\n    vote_average: '8.249',\n    vote_count: '177',\n    popularity: '290.839',\n    overview:\n      'In the late 1990s, the arrival of elderly invalid Patrick into Marion and Tom’s home triggers the exploration of seismic events from 40 years previous: the passionate relationship between Tom and Patrick at a time when homosexuality was illegal.',\n    genre_ids: 'Adventure, Documentary',\n    release_date: '2022-11-04',\n  },\n\n  {\n    poster_path: '/9nAWnMNvFrhSmytB2VLw3OR7BJ3.jpg',\n    id: '2222',\n    title: 'Christine',\n    vote_average: '8.249',\n    vote_count: '177',\n    popularity: '290.839',\n    overview:\n      'In the late 1990s, the arrival of elderly invalid Patrick into Marion and Tom’s home triggers the exploration of seismic events from 40 years previous: the passionate relationship between Tom and Patrick at a time when homosexuality was illegal.',\n    genre_ids: 'Drama',\n    release_date: '2022-11-04',\n  },\n\n  {\n    poster_path: '/8PT4sAcneQ7MtZ1Mqoe2EyOJHmZ.jpg',\n    id: '2323',\n    title: 'Field of Dreams',\n    vote_average: '8.249',\n    vote_count: '177',\n    popularity: '290.839',\n    overview:\n      'In the late 1990s, the arrival of elderly invalid Patrick into Marion and Tom’s home triggers the exploration of seismic events from 40 years previous: the passionate relationship between Tom and Patrick at a time when homosexuality was illegal.',\n    genre_ids: 'Drama, Romance',\n    release_date: '2022-11-04',\n  },\n];\n\nconst refs = refsList();\n\nconst KEY__WATCHED = 'watched';\nconst KEY__QUEUE = 'queue';\n// localStorage.setItem(KEY__WATCHED, JSON.stringify(watched));\n// localStorage.setItem(KEY__QUEUE, JSON.stringify(queue));\n\nif (\n  JSON.parse(!localStorage.getItem(KEY__WATCHED)) ||\n  JSON.parse(localStorage.getItem(KEY__WATCHED)).length === 0\n) {\n  defaultPageShow();\n} else {\n  libraryMainPageBuild();\n}\n\nif (refs.libraryWatchedBtn)\n  refs.libraryWatchedBtn.addEventListener('click', onWatchedBtn);\nif (refs.libraryQueueBtn)\n  refs.libraryQueueBtn.addEventListener('click', onQueueBtn);\n\nfunction onWatchedBtn() {\n  defaultContainerBuild();\n\n  if (JSON.parse(localStorage.getItem(KEY__WATCHED)).length === 0) {\n    defaultPageShow();\n  }\n\n  libraryMainPageBuild();\n\n  refsList().filmsElements.forEach(card =>\n    card.addEventListener('click', onOpenModal)\n  );\n\n  if (refs.libraryWatchedBtn)\n    refs.libraryWatchedBtn.classList.add('header-library__btn-current');\n  if (refs.libraryQueueBtn)\n    refs.libraryQueueBtn.classList.remove('header-library__btn-current');\n}\n\nfunction onQueueBtn() {\n  if (refs.libraryQueueBtn)\n    refs.libraryQueueBtn.classList.add('header-library__btn-current');\n  if (refs.libraryWatchedBtn)\n    refs.libraryWatchedBtn.classList.remove('header-library__btn-current');\n\n  if (\n    !JSON.parse(localStorage.getItem(KEY__QUEUE)) ||\n    JSON.parse(localStorage.getItem(KEY__QUEUE)).length === 0\n  ) {\n    defaultContainerBuild();\n    defaultPageShow();\n  }\n\n  libraryQueuePageBuild();\n}\n\nfunction libraryMainPageBuild() {\n  if (JSON.parse(localStorage.getItem(KEY__WATCHED)).length !== 0) {\n    const markup = JSON.parse(localStorage.getItem(KEY__WATCHED))\n      .map(movie => createMarkUp(movie))\n      .join('');\n    defaultClean();\n    if (refs.libraryMoviesList)\n      refs.libraryMoviesList.insertAdjacentHTML('beforeend', markup);\n  }\n  modalConnection();\n}\n\nfunction libraryQueuePageBuild() {\n  if (JSON.parse(localStorage.getItem(KEY__QUEUE)).length !== 0) {\n    const markup = JSON.parse(localStorage.getItem(KEY__QUEUE))\n      .map(movie => createMarkUp(movie))\n      .join('');\n    defaultClean();\n    if (refs.libraryMoviesList)\n      refs.libraryMoviesList.insertAdjacentHTML('beforeend', markup);\n  }\n  modalConnection();\n}\n\nfunction defaultClean() {\n  if (refs.libraryMoviesList) refs.libraryMoviesList.innerHTML = '';\n  if (refs.libraryDefaultContainer)\n    refs.libraryDefaultContainer.style.display = 'none';\n}\n\nfunction defaultContainerBuild() {\n  if (refs.libraryMoviesList) refs.libraryMoviesList.innerHTML = '';\n  if (refs.libraryDefaultContainer)\n    refs.libraryDefaultContainer.style.display = 'flex';\n}\n\nfunction modalConnection() {\n  refsList().filmsElements.forEach(card =>\n    card.addEventListener('click', onOpenModal)\n  );\n}\n\n"],"names":["$krGWQ","parcelRequire","$d56675a61c457a24$export$2e2bcd8739ae039","$parcel$interopDefault","template","compiler","main","container","depth0","helpers","partials","data","helper","alias1","lambda","alias2","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","hooks","helperMissing","nullContext","name","hash","loc","start","line","column","end","useData","$1cafa503bc57b7a0$var$refs","default","$1cafa503bc57b7a0$export$920aa9f8e14839b8","$1TPJ0","fetchTrendingMovies","then","async","genersList","fetchGenres","forEach","el","newArr","genre_ids","gener","newEl","find","x","id","push","length","splice","join","markup","map","film","slice","libraryMoviesList","insertAdjacentHTML","filmsElements","card","addEventListener","$bTcpz","onOpenModal","renderList","results","console","log","$38912a76373f59c1$var$refs","$38912a76373f59c1$var$libraryMainPageBuild","JSON","parse","localStorage","getItem","movie","$fUAmO","$38912a76373f59c1$var$defaultClean","$38912a76373f59c1$var$modalConnection","innerHTML","libraryDefaultContainer","style","display","$38912a76373f59c1$var$defaultContainerBuild","libraryWatchedBtn","classList","add","libraryQueueBtn","remove","$38912a76373f59c1$var$libraryQueuePageBuild"],"version":3,"file":"library.4cfe80b2.js.map"}